# テスト

## 実行方法

```bash
# 全テスト実行
./gradlew test

# 特定プロジェクトのテスト
./gradlew test --tests "ivantrendafilov_confucius.*"
```

## テスト結果

```
build/reports/tests/test/index.html
```

## テストファイル配置

```
src/test/java/<project>/
└── <Project>Test_<case>.java
```

## テストの仕組み

- テストは Driver.java を経由して各バリアント（original/misuse/fixed）のコードを検証する
- ソースコードを静的解析し、特定のパターン（例外ハンドリング等）の有無を確認する

## テストの分類

| 種類 | 記号 | 説明 |
|---|:---:|---|
| 動的テスト | 🔄 | Driver経由でメソッドを実行し、戻り値やオブジェクトの状態を`assert`で検証 |
| 静的テスト | 📝 | ソースコードを`Files.readString()`等で読み込み、特定パターンの有無を検査 |
| 混合 | 📝+🔄 | 両方のアプローチを併用 |

### 動的テストを優先する理由

- invariant を調査する目的上、実行時の振る舞いを検証する動的テストが本質的に重要
- 可能な限り動的テストで実装することを目指した

### 静的テストとなったケース

「misuse: failed, original: pass」の制約を満たすうえで、以下の理由により動的テストが実装できなかったケースがある：

- **OS 依存**: 特定の OS でのみ発生するバグ
- **確率的発生**: タイミングや状態に依存して確率的に発生するバグ
- **低レイヤー**: システムコールやネイティブライブラリへの依存で再現困難
- **環境依存**: 特殊なハードウェアや外部サービスへの依存

**注意**: 静的テスト（📝）および混合テスト（📝+🔄）は原則、バグ該当箇所の動的検証が通っていない。

詳細な分類一覧は `TEST_CLASSIFICATION.md` を参照。

## テスト対象のバリアント

| バリアント | 期待結果 | 状態 |
|-----------|---------|------|
| original | 通過 | 有効 |
| misuse | 失敗 | コメントアウト |
| fixed | 通過 | 有効（通らない場合はコメントアウト） |

- **misuse**: バグを含むため必ず失敗する。テストでは常にコメントアウト。
- **fixed**: 修正済みのため通過することを期待。通らない場合はコメントアウトしている。
