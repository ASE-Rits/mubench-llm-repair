# Project: testng / Case: 22

## original.java -> misuse.java
-    synchronized(results) {
-      for (Map.Entry<String, ISuiteResult> result : results.entrySet()) {
-        ITestContext testContext = result.getValue().getTestContext();
-        Date startDate = testContext.getStartDate();
-        Date endDate = testContext.getEndDate();
-        if (minStartDate.after(startDate)) {
-          minStartDate = startDate;
-        }
-        if (maxEndDate == null || maxEndDate.before(endDate)) {
-          maxEndDate = endDate != null ? endDate : startDate;
-        }
+    for (Map.Entry<String, ISuiteResult> result : results.entrySet()) {
+      ITestContext testContext = result.getValue().getTestContext();
+      Date startDate = testContext.getStartDate();
+      Date endDate = testContext.getEndDate();
+      if (minStartDate.after(startDate)) {
+        minStartDate = startDate;
+      }
+      if (maxEndDate == null || maxEndDate.before(endDate)) {
+        maxEndDate = endDate != null ? endDate : startDate;
+

## misuse.java -> fixed.java
-    for (Map.Entry<String, ISuiteResult> result : results.entrySet()) {
-      suiteResultWriter.writeSuiteResult(xmlBuffer, result.getValue());
+    synchronized (results) {
+      for (Map.Entry<String, ISuiteResult> result : results.entrySet()) {
+        suiteResultWriter.writeSuiteResult(xmlBuffer, result.getValue());
+      }
-    for (Map.Entry<String, ISuiteResult> result : results.entrySet()) {
-      ITestContext testContext = result.getValue().getTestContext();
-      Date startDate = testContext.getStartDate();
-      Date endDate = testContext.getEndDate();
-      if (minStartDate.after(startDate)) {
-        minStartDate = startDate;
-      }
-      if (maxEndDate == null || maxEndDate.before(endDate)) {
-        maxEndDate = endDate != null ? endDate : startDate;
+    synchronized (results) {
+      for (Map.Entry<String, ISuiteResult> result : results.entrySet()) {
+        ITestContext testContext = result.getValue().getTestContext();
+        Date startDate = testContext.getStartDate();
+        Date endDate = testContext.getEndDate();
+        if (minStartDate.after(startDate)) {
+          minStartDate = startDate;
+        }
+        if (maxEndDate == null || maxEndDate.before(endDate)) {
+          maxEndDate = endDate != null ? endDate : startDate;
+        }
-}
+}

## original.java -> fixed.java
-    for (Map.Entry<String, ISuiteResult> result : results.entrySet()) {
-      suiteResultWriter.writeSuiteResult(xmlBuffer, result.getValue());
+    synchronized (results) {
+      for (Map.Entry<String, ISuiteResult> result : results.entrySet()) {
+        suiteResultWriter.writeSuiteResult(xmlBuffer, result.getValue());
+      }
-    synchronized(results) {
+    synchronized (results) {
+
-}
+}
